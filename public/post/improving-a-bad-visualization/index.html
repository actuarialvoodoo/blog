<!doctype html>

<html lang="en">

<head>
  <title>Ryan Thomas</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The HTML5 Herald" />
  <meta name="author" content="Ryan Thomas" />
  <meta name="generator" content="Hugo 0.53" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda" />
  <link rel="stylesheet" type="text/css" href="/css/styles.css" />
</head>

<body>
  <div id="container">
    <header>
      <h1>
                <a href="/">Ryan Thomas</a>
            </h1>

      <ul id="social-media">
        
        <li><a href="https://twitter.com/ryebreadnyc"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
         
        <li><a href="https://www.linkedin.com/in/ryan-thomas-5387028"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
         
        <li><a href="https://github.com/actuarialvoodoo"><i class="fa fa-github fa-lg" aria-hidden="true"></i></a></li>
           
      </ul>
      
      <p><em>Actuary. Nerd. Data Scientist?</em></p>
      
    </header>

    
<nav>
    <ul>
        
        <li>
            <a class="" href="/posts/">
                <i class="fa-li fa  fa-lg"></i><span>Posts</span>
            </a>
        </li>
        
        <li>
            <a class="" href="/about/">
                <i class="fa-li fa  fa-lg"></i><span>About</span>
            </a>
        </li>
        
    </ul>
</nav>

    <main>




<article>

    <h1>Improving a Bad Visualization</h1>

    
        <aside>
    <ul>
        <li>
            <time class="post-date" datetime="2019-02-17T00:00:00Z">Feb 17, 2019</time>
        </li>
        
        

        

        <li>2 min read</li>
    </ul>
</aside>
    

    


<p>I was recently working on a project at work and a stakeholder was really stoked about the “chart” they had come up. They were adamant that I add it to the analytics package I was working on.</p>
<p>The original version was put together in Powerpoint. I have reproduced it below using ggplot.</p>
<p>Take a look and see if you can figure out what it’s trying to communicate.</p>
<pre class="r"><code>suppressPackageStartupMessages({
        library(tidyverse)
        library(glue)
        })

d_raw &lt;- tribble(
  ~py, ~delta,
  2018,  -256,
  2019,  -190,
  2020,  -125,
  2021,   -56,
  2022,   -15,
  2023,    98,
  2024,   210,
  2025,   305,
  2026,   400
)

d &lt;- mutate(d_raw, 
            scenario = as.factor(case_when(delta &gt; 0 ~ &quot;alternative&quot;, TRUE ~ &quot;baseline&quot;)),
            label = glue(&quot;${abs(delta)}&quot;)
)
d</code></pre>
<pre><code>## # A tibble: 9 x 4
##      py delta scenario    label     
##   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;       &lt;S3: glue&gt;
## 1  2018  -256 baseline    $256      
## 2  2019  -190 baseline    $190      
## 3  2020  -125 baseline    $125      
## 4  2021   -56 baseline    $56       
## 5  2022   -15 baseline    $15       
## 6  2023    98 alternative $98       
## 7  2024   210 alternative $210      
## 8  2025   305 alternative $305      
## 9  2026   400 alternative $400</code></pre>
<pre class="r"><code>ggplot(d, aes(x = py)) + 
        geom_point(aes(y = 1, size = abs(delta), color = scenario)) +
        scale_size(range = c(5, 22)) +
        geom_text(aes(y = 1, label = label)) + 
        scale_color_manual(values = c(&quot;#FF7F50&quot;, &quot;#1E90FF&quot;)) +
        geom_vline(xintercept = c(2022 + 2/3, 2025 + 2/3), linetype = &quot;dashed&quot;) +
        geom_label(aes(x = 2022, y = 1.45, label = &quot;Breakeven 68\nmonths&quot;)) +
        geom_label(aes(x = 2024.9, y = 1.45, label = &quot;Realized gains\nbegin month 104&quot;)) +
        geom_segment(aes(x = 2017.5, xend = 2022.5, y = 1.2, yend = 1.2), color = &quot;blue&quot;) +
        geom_text(aes(x = 2020, y = 1.27), label = &quot;$647k in capital invesment in the first\n68  months needed to generate returns&quot;) +
        scale_x_continuous(breaks = 2018:2026) +
        scale_y_continuous(limits = c(0.5, 1.5)) + 
        theme_bw() +
        guides(size = FALSE) +
        theme(legend.position = &quot;bottom&quot;, axis.title.y = element_blank(), axis.text.y = element_blank())</code></pre>
<p><img src="/post/2019-02-17-improving-a-bad-visualization_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>d_alt &lt;- split(d, d$py) %&gt;%
        map_dfr( ~ tibble(py = .x$py, pm = 1:12, mdelta = .x$delta /12 * 1:12)) %&gt;%
        mutate(use_date = lubridate::ymd(glue::glue(&quot;{py}-{pm}-01&quot;)),
               cumdelta = cumsum(mdelta), start = cumdelta - mdelta,
               scenario = as.factor(case_when(mdelta &gt; 0 ~ &quot;savings&quot;, TRUE ~ &quot;costs&quot;))
               )</code></pre>
<pre class="r"><code>ggplot(d_alt) + 
        geom_rect(aes(xmin = use_date - 16, 
                      xmax = use_date + 16, 
                      ymin = start, 
                      ymax = cumdelta,
                      fill = scenario))</code></pre>
<p><img src="/post/2019-02-17-improving-a-bad-visualization_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>          #scale_x_continuous(breaks = 2018:202, expand = c(0, 0),
          #           sec.axis = sec_axis(~ 12*(. - 2017), name = &quot;Months into Future&quot;, breaks = 12*(1:9))) </code></pre>


</article>


<section class="post-nav">
    <ul>
        
        <li>
            <a href="/post/2015-07-23-r-rmarkdown/"><i class="fa fa-chevron-circle-left"></i> Hello R Markdown</a>
        </li>
        
        
    </ul>
</section>
    





</main>
    <footer>
        <h6>Copyright &copy; 2019 - Ryan Thomas | 
            Rendered by <a href="https://gohugo.io" title="Hugo">Hugo</a> |
            <a href="/index.xml">Subscribe</a></h6>
    </footer>
</div>
<script src="/js/scripts.js"></script>
</body>

</html>